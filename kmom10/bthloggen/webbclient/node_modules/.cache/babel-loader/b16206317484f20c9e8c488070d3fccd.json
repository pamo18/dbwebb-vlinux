{"ast":null,"code":"var _jsxFileName = \"/Users/office/Documents/dbwebb-kurser/vlinux/me/kmom10/bthloggen/webbclient/src/components/form/Register.js\";\n\n/*eslint max-len: [\"error\", { \"code\": 200 }]*/\nimport React, { Component } from 'react';\nimport DatePicker from './DatePicker.js';\nimport utils from '../../utils/utils.js';\nimport base from '../../config/api.js';\nlet api = base.api();\n\nclass Register extends Component {\n  constructor(props) {\n    super(props);\n    this.registerSubmit = this.registerSubmit.bind(this);\n    this.onPasswordChange = this.onPasswordChange.bind(this);\n    this.toggleShowPassword = this.toggleShowPassword.bind(this);\n    this.getCountries = this.getCountries.bind(this);\n    this.commonCountries = this.commonCountries.bind(this);\n    this.addToCommon = this.addToCommon.bind(this);\n    this.state = {\n      countries: \"\",\n      commonOptions: \"\",\n      commonCountries: \"\",\n      showing: false,\n      password: \"\",\n      hidden: true,\n      button: true,\n      strength: 0\n    };\n  }\n\n  componentDidMount() {\n    this.getCountries();\n    this.commonCountries();\n  }\n\n  registerSubmit(event) {\n    const that = this;\n    event.preventDefault();\n    const data = new FormData(event.target);\n    let person = {\n      \"name\": data.get('name'),\n      \"birthday\": data.get('date'),\n      \"country\": data.get('country'),\n      \"email\": data.get('email'),\n      \"password\": data.get('password')\n    };\n    fetch(api + \"/register\", {\n      method: 'POST',\n      body: JSON.stringify(person),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function () {\n      let common = {\n        \"countries\": that.state.commonCountries.join(\",\")\n      };\n      fetch(api + \"/common/countries\", {\n        method: 'POST',\n        body: JSON.stringify(common),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).then(that.props.history.push('/login'));\n    });\n  }\n\n  addToCommon(e) {\n    let common = this.state.commonCountries,\n        country = e.target.value;\n\n    if (common.includes(country)) {\n      common.unshift(country);\n\n      if (common.length > 3) {\n        common.pop();\n      }\n\n      this.setState({\n        commonCountries: common\n      });\n    }\n  }\n\n  commonCountries() {\n    let commonOptions = [],\n        commonCountries = [];\n    const that = this;\n    fetch(api + \"/common/countries\").then(res => res.json()).then(function (res) {\n      let result = res.data.common.item;\n      result = result.split(\",\");\n      result.forEach(function (row) {\n        commonOptions.push(React.createElement(\"option\", {\n          key: row,\n          value: row.country,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, row));\n        commonCountries.push(row);\n      });\n      that.setState({\n        commonOptions: commonOptions,\n        commonCountries: commonCountries\n      });\n    });\n  }\n\n  getCountries() {\n    let countries = [];\n    const that = this;\n    fetch(api + \"/countries\").then(res => res.json()).then(function (res) {\n      let result = res.data.countries;\n      result.forEach(function (row) {\n        countries.push(React.createElement(\"option\", {\n          key: row.country,\n          value: row.county,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, row.country));\n      });\n      that.setState({\n        countries: countries\n      });\n    });\n  }\n\n  onPasswordChange(e) {\n    this.setState({\n      strength: utils.passwordChecker(e.target.value),\n      password: e.target.value\n    });\n  }\n\n  toggleShowPassword() {\n    this.setState({\n      hidden: !this.state.hidden,\n      button: !this.state.button\n    });\n  }\n\n  render() {\n    const showing = this.state.showing;\n    return React.createElement(\"div\", {\n      className: \"form-wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"Registration\"), React.createElement(\"p\", {\n      className: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"To be able to view your profile you must first register.\"), React.createElement(\"form\", {\n      action: \"/login\",\n      className: \"form-register\",\n      onSubmit: this.registerSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Username\", React.createElement(\"input\", {\n      className: \"form-input\",\n      type: \"text\",\n      name: \"name\",\n      required: true,\n      placeholder: \"Your username\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \"Birthday\", React.createElement(\"input\", {\n      onClick: () => this.setState({\n        showing: !showing\n      }),\n      id: \"birthday\",\n      className: \"form-input\",\n      type: \"date\",\n      name: \"date\",\n      required: true,\n      placeholder: \"Click to choose!\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), showing ? React.createElement(DatePicker, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }) : null), React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"Country\", React.createElement(\"select\", {\n      onChange: this.addToCommon,\n      className: \"form-input\",\n      type: \"text\",\n      name: \"country\",\n      required: true,\n      placeholder: \"Your current location\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"optgroup\", {\n      label: \"Common countries\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, this.state.commonOptions), React.createElement(\"optgroup\", {\n      label: \"Other countries\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, this.state.countries))), React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Email\", React.createElement(\"input\", {\n      className: \"form-input\",\n      type: \"email\",\n      name: \"email\",\n      required: true,\n      placeholder: \"abc@mail.com\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \"Password: 1 capital letter, 1 number, 4+ characters long.\", React.createElement(\"input\", {\n      className: \"form-input password\",\n      type: this.state.hidden ? \"password\" : \"text\",\n      name: \"password\",\n      pattern: \"(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{4,}\",\n      value: this.state.password,\n      placeholder: \"Your password\",\n      onChange: this.onPasswordChange,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"show-password\",\n      onClick: this.toggleShowPassword,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }), \" \", this.state.button ? \"Show\" : \"Hide\", \" password\")), React.createElement(\"label\", {\n      className: \"form-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Password strength\", React.createElement(\"meter\", {\n      className: \"form-meter\",\n      min: \"0\",\n      low: \"4\",\n      optimum: \"9\",\n      high: \"8\",\n      max: \"10\",\n      value: this.state.strength,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      className: \"form-label check-label\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"check-input\",\n      type: \"checkbox\",\n      name: \"gdpr\",\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }), \"I agree to the \", React.createElement(\"a\", {\n      href: \"https://en.wikipedia.org/wiki/Terms_of_service\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Terms and Conditions\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      className: \"button form-button center\",\n      type: \"submit\",\n      name: \"register\",\n      value: \"Register\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default Register;","map":{"version":3,"sources":["/Users/office/Documents/dbwebb-kurser/vlinux/me/kmom10/bthloggen/webbclient/src/components/form/Register.js"],"names":["React","Component","DatePicker","utils","base","api","Register","constructor","props","registerSubmit","bind","onPasswordChange","toggleShowPassword","getCountries","commonCountries","addToCommon","state","countries","commonOptions","showing","password","hidden","button","strength","componentDidMount","event","that","preventDefault","data","FormData","target","person","get","fetch","method","body","JSON","stringify","headers","then","common","join","history","push","e","country","value","includes","unshift","length","pop","setState","res","json","result","item","split","forEach","row","county","passwordChecker","render"],"mappings":"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","sourcesContent":["/*eslint max-len: [\"error\", { \"code\": 200 }]*/\n\nimport React, { Component } from 'react';\nimport DatePicker from './DatePicker.js';\nimport utils from '../../utils/utils.js';\nimport base from '../../config/api.js';\nlet api = base.api();\n\nclass Register extends Component {\n    constructor(props) {\n        super(props);\n        this.registerSubmit = this.registerSubmit.bind(this);\n        this.onPasswordChange = this.onPasswordChange.bind(this);\n        this.toggleShowPassword = this.toggleShowPassword.bind(this);\n        this.getCountries = this.getCountries.bind(this);\n        this.commonCountries = this.commonCountries.bind(this);\n        this.addToCommon = this.addToCommon.bind(this);\n        this.state = {\n            countries: \"\",\n            commonOptions: \"\",\n            commonCountries: \"\",\n            showing: false,\n            password: \"\",\n            hidden: true,\n            button: true,\n            strength: 0\n        };\n    }\n    componentDidMount() {\n        this.getCountries();\n        this.commonCountries();\n    }\n    registerSubmit(event) {\n        const that = this;\n\n        event.preventDefault();\n        const data = new FormData(event.target);\n\n        let person = {\n            \"name\": data.get('name'),\n            \"birthday\": data.get('date'),\n            \"country\": data.get('country'),\n            \"email\": data.get('email'),\n            \"password\": data.get('password')\n        };\n\n\n        fetch(api + \"/register\", {\n            method: 'POST',\n            body: JSON.stringify(person),\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        }).then(function() {\n            let common = {\n                \"countries\": that.state.commonCountries.join(\",\")\n            };\n\n            fetch(api + \"/common/countries\", {\n                method: 'POST',\n                body: JSON.stringify(common),\n                headers: {\n                    'Content-Type': 'application/json'\n                }\n            }).then(that.props.history.push('/login'));\n        });\n    }\n    addToCommon(e) {\n        let common = this.state.commonCountries,\n            country = e.target.value;\n\n        if (common.includes(country)) {\n            common.unshift(country);\n            if (common.length > 3) {\n                common.pop();\n            }\n            this.setState({\n                commonCountries: common\n            });\n        }\n    }\n    commonCountries() {\n        let commonOptions = [],\n            commonCountries = [];\n\n        const that = this;\n\n        fetch(api + `/common/countries`)\n            .then(res => res.json())\n            .then(function(res) {\n                let result = res.data.common.item;\n\n                result = result.split(\",\");\n                result.forEach(function (row) {\n                    commonOptions.push(<option key={row} value={row.country}>{row}</option>);\n                    commonCountries.push(row);\n                });\n                that.setState({\n                    commonOptions: commonOptions,\n                    commonCountries: commonCountries\n                });\n            });\n    }\n    getCountries() {\n        let countries = [];\n\n        const that = this;\n\n        fetch(api + `/countries`)\n            .then(res => res.json())\n            .then(function(res) {\n                let result = res.data.countries;\n\n                result.forEach(function (row) {\n                    countries.push(<option key={row.country} value={row.county}>{row.country}</option>);\n                });\n                that.setState({\n                    countries: countries\n                });\n            });\n    }\n    onPasswordChange(e) {\n        this.setState({\n            strength: utils.passwordChecker(e.target.value),\n            password: e.target.value\n        });\n    }\n    toggleShowPassword() {\n        this.setState({\n            hidden: !this.state.hidden,\n            button: !this.state.button\n        });\n    }\n    render() {\n        const { showing } = this.state;\n\n        return (\n            <div className=\"form-wrapper\">\n                <h1>Registration</h1>\n                <p className=\"center\">To be able to view your profile you must first register.</p>\n                <form action=\"/login\" className=\"form-register\" onSubmit={this.registerSubmit}>\n                    <label className=\"form-label\">Username\n                        <input className=\"form-input\" type=\"text\" name=\"name\" required placeholder=\"Your username\" />\n                    </label>\n\n                    <label className=\"form-label\">Birthday\n                        <input onClick={() => this.setState({ showing: !showing })} id=\"birthday\" className=\"form-input\" type=\"date\" name=\"date\" required placeholder=\"Click to choose!\" />\n                        { showing\n                            ? <DatePicker />\n                            : null\n                        }\n                    </label>\n\n                    <label className=\"form-label\">Country\n                        <select onChange={this.addToCommon} className=\"form-input\" type=\"text\" name=\"country\" required placeholder=\"Your current location\">\n                            <optgroup label=\"Common countries\">\n                                { this.state.commonOptions }\n                            </optgroup>\n                            <optgroup label=\"Other countries\">\n                                { this.state.countries }\n                            </optgroup>\n                        </select>\n                    </label>\n\n                    <label className=\"form-label\">Email\n                        <input className=\"form-input\" type=\"email\" name=\"email\" required placeholder=\"abc@mail.com\" />\n                    </label>\n\n                    <label className=\"form-label\">Password: 1 capital letter, 1 number, 4+ characters long.\n                        <input\n                            className=\"form-input password\"\n                            type={this.state.hidden ? \"password\" : \"text\"}\n                            name=\"password\"\n                            pattern=\"(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{4,}\"\n                            value={this.state.password}\n                            placeholder=\"Your password\"\n                            onChange={this.onPasswordChange}\n                            required\n                        />\n                        <p><input type=\"checkbox\" className=\"show-password\" onClick={this.toggleShowPassword} /> {this.state.button ? \"Show\" : \"Hide\"} password</p>\n                    </label>\n\n                    <label className=\"form-label\">Password strength\n                        <meter className=\"form-meter\" min=\"0\" low=\"4\" optimum=\"9\" high=\"8\" max=\"10\" value={this.state.strength}></meter>\n                    </label>\n\n                    <label className=\"form-label check-label\">\n                        <input className=\"check-input\" type=\"checkbox\" name=\"gdpr\" required />\n                        I agree to the <a href=\"https://en.wikipedia.org/wiki/Terms_of_service\">Terms and Conditions</a>\n                    </label><br />\n\n\n                    <input className=\"button form-button center\" type=\"submit\" name=\"register\" value=\"Register\" />\n                </form>\n            </div>\n        );\n    }\n}\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}